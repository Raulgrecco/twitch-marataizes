<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Overlay TV Marataízes</title>

<!-- Evita cache -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
  :root{
    /* ====== AJUSTES RÁPIDOS ====== */
    --ticker-h: 88px;         /* altura do rodapé */
    --ticker-fs: 34px;        /* fonte do rodapé */
    --speed: 38s;             /* ajustado via JS */
    /* Cores */
    --gn-red: #C4170C;        /* vermelho estilo GloboNews */
    --top-bg: #0a1628;        /* faixa do topo (clima) */
    --text:   #ffffff;
  }

  html,body{
    margin:0;height:100%;background:transparent;
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
    color:var(--text)
  }

  /* ===== TOPO: Clima ===== */
  .topbar{
    display:none; /* padrão: oculto; use [data-show="1"] para exibir */
    position:fixed; top:0; left:0; right:0; height:56px;
    background:var(--top-bg); align-items:center; padding:0 16px;
    box-shadow:0 6px 16px rgba(0,0,0,.25); pointer-events:none
  }
  .topbar[data-show="1"]{ display:flex; }
  .topbar iframe{ width:100%; height:36px; border:0; background:transparent; pointer-events:none }

  /* ===== RODAPÉ: Ticker ===== */
  .ticker{
    position:fixed; left:0; right:0; bottom:0; height:var(--ticker-h);
    background:var(--gn-red); display:flex; align-items:center; gap:18px;
    overflow:hidden; border-top:4px solid rgba(0,0,0,.15);
    box-shadow:0 -10px 28px rgba(0,0,0,.35); pointer-events:none
  }
  .pill{
    margin-left:16px; padding:10px 14px; border-radius:10px; background:#000; color:#fff;
    font-weight:900; letter-spacing:.3px; text-transform:uppercase; white-space:nowrap; pointer-events:auto;
    box-shadow:0 2px 0 rgba(255,255,255,.1) inset;
  }
  .track{ position:relative; flex:1; height:100%; overflow:hidden }
  .lane{
    position:absolute; top:0; left:0; height:100%;
    display:inline-flex; align-items:center; gap:36px; white-space:nowrap;
    font-weight:900; font-size:var(--ticker-fs);
    will-change:transform; animation:scroll var(--speed) linear infinite
  }
  @keyframes scroll{ from{transform:translateX(100%)} to{transform:translateX(-100%)} }

  /* ===== Responsivo ===== */
  @media (max-width: 900px){
    :root{ --ticker-h:72px; --ticker-fs:28px }
    .topbar{ height:52px }
    .topbar iframe{ height:32px }
  }
</style>
</head>
<body>

  <!-- TOPO: Clima | mude data-show="1" (mostrar) ou "0" (ocultar) -->
  <div class="topbar" data-show="1" aria-label="Clima agora">
    <iframe
      src="https://www.meteoblue.com/en/weather/widget/daily/marataizes_brazil_3457819?geoloc=fixed&days=0&tempunit=CELSIUS&windunit=KILOMETER_PER_HOUR&precipunit=MILLIMETER&coloured=0&pictoicon=1&maxtemperature=1&mintemperature=1"
      scrolling="no" allowtransparency="true"
      sandbox="allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox">
    </iframe>
  </div>

  <!-- RODAPÉ: Ticker -->
  <div class="ticker" role="marquee" aria-label="Notícias">
    <div class="pill" id="pillLabel">AO VIVO</div>
    <div class="track"><div class="lane" id="laneA"></div></div>
  </div>

<script>
  // ===== Rótulo da pílula (troque aqui sem mexer no HTML) =====
  document.getElementById('pillLabel').textContent = 'AO VIVO'; // ex.: 'EM BREVE', 'ESPECIAL'

  const lane = document.getElementById('laneA');

  // Mensagem fallback
  const DEFAULT_MSG =
    'Somzera e Imagem pro Relax — Siga @maratheizeTV • ' +
    'Programação com blocos do Brasil, Mundo e Espírito Santo • ' +
    'Marataízes: gente batalhadora, comércio local e muita cultura.';

  // Base path para GitHub Pages (resolve /repo/)
  function basePath(){
    const p = location.pathname.replace(/[^/]+$/, '');
    return p.endsWith('/') ? p : p + '/';
  }

  function setMessage(msg) {
    const base = (msg || '').trim();
    lane.innerHTML = '';
    for (let i = 0; i < 10; i++) {
      const s = document.createElement('span');
      s.textContent = (base || ' ') + ' • ';
      lane.appendChild(s);
    }
    autoSpeed();
  }

  function autoSpeed(){
    const width = lane.scrollWidth || 2000;
    const pxPerSec = Math.max(50, Math.min(110, window.innerWidth/10)); // adapta à tela
    const dur = Math.max(20, Math.round(width / pxPerSec));
    document.documentElement.style.setProperty('--speed', dur + 's');
  }

  // Busca ticker.txt a cada 10s; se não achar, usa DEFAULT_MSG
  async function pull() {
    try {
      const url = basePath() + 'ticker.txt?ts=' + Date.now();
      const res = await fetch(url, { cache: 'no-store' });
      const txt = res.ok ? (await res.text()).trim().replace(/\n+/g,' • ') : '';
      setMessage(txt || DEFAULT_MSG);
    } catch {
      setMessage(DEFAULT_MSG);
    }
  }

  setMessage('Carregando…');
  pull();                   // ao abrir
  setInterval(pull, 10_000); // atualiza periodicamente
  window.addEventListener('resize', autoSpeed);
</script>
</body>
</html>
