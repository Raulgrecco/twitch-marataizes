<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Overlay • Barra + Ticker (simples)</title>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<style>
  :root{ --primary:#d7262b; --slug:#111; --barMinH:64px; }
  *{box-sizing:border-box} html,body{height:100%}
  body{ margin:0; background:transparent; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans",sans-serif; overflow:hidden; }

  .bar{ position:fixed; top:0; left:0; right:0; z-index:3200; background:#fff;
        box-shadow:0 3px 18px rgba(0,0,0,.22); display:flex; align-items:center; gap:14px;
        padding:10px 22px; min-height:var(--barMinH); }
  .dot{ width:12px; height:12px; border-radius:50%; background:#ff3b3b; }
  .title{ font-weight:900; font-size:34px; line-height:1.1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

  .clock{ position:fixed; top:8px; right:16px; z-index:3400; display:flex; gap:8px; align-items:center;
          background:rgba(0,0,0,.85); color:#fff; padding:6px 10px; border-radius:10px; font-weight:800; font-size:16px; }

  .gnbar{ position:fixed; left:0; right:0; bottom:0; height:72px; z-index:2500; background:var(--primary);
          color:#fff; display:flex; align-items:center; overflow:hidden; border-top:3px solid rgba(0,0,0,.25); }
  .slug{ background:var(--slug); color:#fff; font-weight:900; font-size:20px; letter-spacing:.9px;
         padding:10px 18px; margin-left:10px; border-radius:8px; text-transform:uppercase; flex:0 0 auto; }
  .track{ position:relative; flex:1 1 auto; height:100%; overflow:hidden; }
  .rail{ position:absolute; inset:0; display:flex; align-items:center; gap:90px; white-space:nowrap; padding-left:30px;
         will-change:transform; animation:scroll 8s linear infinite; font-size:28px; font-weight:900; line-height:72px; }
  .copy{flex:0 0 auto;}
  @keyframes scroll{ 0%{transform:translateX(0)} 100%{transform:translateX(-50%)} }
</style>
</head>
<body>

  <!-- Topo -->
  <div class="bar">
    <div class="dot" aria-hidden="true"></div>
    <div class="title" id="topTitle">Carregando…</div>
  </div>

  <!-- Relógio -->
  <div class="clock">
    <div id="clockTime">--:--</div>
    <div id="clockDate">--/--/----</div>
  </div>

  <!-- Ticker -->
  <div class="gnbar" role="marquee" aria-label="Rodapé de notícias">
    <div class="slug" id="slug">NEWS</div>
    <div class="track">
      <div class="rail">
        <div class="copy" id="a">Carregando…</div>
        <div class="copy" id="b">Carregando…</div>
      </div>
    </div>
  </div>

<script>
  // ===== Relógio =====
  const pad2 = n => String(n).padStart(2,'0');
  function updClock(){
    const now = new Date();
    clockTime.textContent = `${pad2(now.getHours())}:${pad2(now.getMinutes())}`;
    clockDate.textContent = `${pad2(now.getDate())}/${pad2(now.getMonth()+1)}/${now.getFullYear()}`;
  }
  updClock(); setInterval(updClock, 1000);

  // ===== Leitura dos .txt (sem cache) =====
  async function fetchText(path){
    const url = `${path}?_=${Date.now()}`; // cache buster automático
    const res = await fetch(url, { cache: "no-store" });
    if (!res.ok) throw new Error(`Falha ao carregar ${path}`);
    return (await res.text()).trim();
  }

  async function loadTop(){
    try{
      const txt = await fetchText("./top.txt");
      topTitle.textContent = txt || " ";
    }catch(e){
      topTitle.textContent = topTitle.textContent || " ";
    }
  }

  async function loadTicker(){
    try{
      const raw = await fetchText("./ticker.txt");
      const lines = raw.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
      const text = (lines.length? lines : ["TV Marataízes ao vivo"]).join("  •  ");
      a.textContent = text;
      b.textContent = text;
    }catch(e){
      const fallback = a.textContent || "TV Marataízes ao vivo";
      a.textContent = fallback;
      b.textContent = fallback;
    }
  }

  async function loadAll(){ await Promise.all([loadTop(), loadTicker()]); }
  loadAll();
  setInterval(loadAll, 10000); // atualiza a cada 10s
</script>
</body>
</html>
